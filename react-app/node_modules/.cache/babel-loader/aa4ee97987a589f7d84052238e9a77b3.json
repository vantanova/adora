{"ast":null,"code":"import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/esm/createSuper\";\nimport React, { Component } from 'react';\nimport classNames from 'classnames';\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport defaultRequest from './request';\nimport getUid from './uid';\nimport attrAccept from './attr-accept';\nimport traverseFileTree from './traverseFileTree';\n\nvar AjaxUploader = /*#__PURE__*/function (_Component) {\n  _inherits(AjaxUploader, _Component);\n\n  var _super = _createSuper(AjaxUploader);\n\n  function AjaxUploader() {\n    var _this;\n\n    _classCallCheck(this, AjaxUploader);\n\n    _this = _super.apply(this, arguments);\n    _this.state = {\n      uid: getUid()\n    };\n    _this.reqs = {};\n\n    _this.onChange = function (e) {\n      var files = e.target.files;\n\n      _this.uploadFiles(files);\n\n      _this.reset();\n    };\n\n    _this.onClick = function (e) {\n      var el = _this.fileInput;\n\n      if (!el) {\n        return;\n      }\n\n      var _this$props = _this.props,\n          children = _this$props.children,\n          onClick = _this$props.onClick;\n\n      if (children && children.type === 'button') {\n        var parent = el.parentNode;\n        parent.focus();\n        parent.querySelector('button').blur();\n      }\n\n      el.click();\n\n      if (onClick) {\n        onClick(e);\n      }\n    };\n\n    _this.onKeyDown = function (e) {\n      if (e.key === 'Enter') {\n        _this.onClick(e);\n      }\n    };\n\n    _this.onFileDrop = function (e) {\n      var multiple = _this.props.multiple;\n      e.preventDefault();\n\n      if (e.type === 'dragover') {\n        return;\n      }\n\n      if (_this.props.directory) {\n        traverseFileTree(Array.prototype.slice.call(e.dataTransfer.items), _this.uploadFiles, function (_file) {\n          return attrAccept(_file, _this.props.accept);\n        });\n      } else {\n        var files = Array.prototype.slice.call(e.dataTransfer.files).filter(function (file) {\n          return attrAccept(file, _this.props.accept);\n        });\n\n        if (multiple === false) {\n          files = files.slice(0, 1);\n        }\n\n        _this.uploadFiles(files);\n      }\n    };\n\n    _this.uploadFiles = function (files) {\n      var originFiles = _toConsumableArray(files);\n\n      var postFiles = originFiles.map(function (file) {\n        // eslint-disable-next-line no-param-reassign\n        file.uid = getUid();\n        return _this.processFile(file, originFiles);\n      }); // Batch upload files\n\n      Promise.all(postFiles).then(function (fileList) {\n        var onBatchStart = _this.props.onBatchStart;\n        onBatchStart === null || onBatchStart === void 0 ? void 0 : onBatchStart(fileList.map(function (_ref) {\n          var origin = _ref.origin,\n              parsedFile = _ref.parsedFile;\n          return {\n            file: origin,\n            parsedFile: parsedFile\n          };\n        }));\n        fileList.filter(function (file) {\n          return file.parsedFile !== null;\n        }).forEach(function (file) {\n          _this.post(file);\n        });\n      });\n    };\n    /**\n     * Process file before upload. When all the file is ready, we start upload.\n     */\n\n\n    _this.processFile = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(file, fileList) {\n        var _this$props2, beforeUpload, action, data, transformedFile, mergedAction, mergedData, parsedFile;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this$props2 = _this.props, beforeUpload = _this$props2.beforeUpload, action = _this$props2.action, data = _this$props2.data;\n                transformedFile = file;\n\n                if (!beforeUpload) {\n                  _context.next = 14;\n                  break;\n                }\n\n                _context.prev = 3;\n                _context.next = 6;\n                return beforeUpload(file, fileList);\n\n              case 6:\n                transformedFile = _context.sent;\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](3); // Rejection will also trade as false\n\n                transformedFile = false;\n\n              case 12:\n                if (!(transformedFile === false)) {\n                  _context.next = 14;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", {\n                  origin: file,\n                  parsedFile: null,\n                  action: null,\n                  data: null\n                });\n\n              case 14:\n                if (!(typeof action === 'function')) {\n                  _context.next = 20;\n                  break;\n                }\n\n                _context.next = 17;\n                return action(file);\n\n              case 17:\n                mergedAction = _context.sent;\n                _context.next = 21;\n                break;\n\n              case 20:\n                mergedAction = action;\n\n              case 21:\n                if (!(typeof data === 'function')) {\n                  _context.next = 27;\n                  break;\n                }\n\n                _context.next = 24;\n                return data(file);\n\n              case 24:\n                mergedData = _context.sent;\n                _context.next = 28;\n                break;\n\n              case 27:\n                mergedData = data;\n\n              case 28:\n                parsedFile = // string type is from legacy `transformFile`.\n                // Not sure if this will work since no related test case works with it\n                (_typeof(transformedFile) === 'object' || typeof transformedFile === 'string') && transformedFile ? transformedFile : file; // Used for `request.ts` get form data name\n\n                if (_typeof(parsedFile) === 'object' && !parsedFile.name) {\n                  parsedFile.name = file.name;\n                }\n\n                return _context.abrupt(\"return\", {\n                  origin: file,\n                  data: mergedData,\n                  parsedFile: parsedFile,\n                  action: mergedAction\n                });\n\n              case 31:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[3, 9]]);\n      }));\n\n      return function (_x, _x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.saveFileInput = function (node) {\n      _this.fileInput = node;\n    };\n\n    return _this;\n  }\n\n  _createClass(AjaxUploader, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = true;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n      this.abort();\n    }\n  }, {\n    key: \"post\",\n    value: function post(_ref3) {\n      var _this2 = this;\n\n      var data = _ref3.data,\n          origin = _ref3.origin,\n          action = _ref3.action,\n          parsedFile = _ref3.parsedFile;\n\n      if (!this._isMounted) {\n        return;\n      }\n\n      var _this$props3 = this.props,\n          onStart = _this$props3.onStart,\n          customRequest = _this$props3.customRequest,\n          name = _this$props3.name,\n          headers = _this$props3.headers,\n          withCredentials = _this$props3.withCredentials,\n          method = _this$props3.method;\n      var uid = origin.uid;\n      var request = customRequest || defaultRequest;\n      var requestOption = {\n        action: action,\n        filename: name,\n        data: data,\n        file: parsedFile,\n        headers: headers,\n        withCredentials: withCredentials,\n        method: method || 'post',\n        onProgress: function onProgress(e) {\n          var onProgress = _this2.props.onProgress;\n          onProgress === null || onProgress === void 0 ? void 0 : onProgress(e, origin);\n        },\n        onSuccess: function onSuccess(ret, xhr) {\n          var onSuccess = _this2.props.onSuccess;\n          onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(ret, origin, xhr);\n          delete _this2.reqs[uid];\n        },\n        onError: function onError(err, ret) {\n          var onError = _this2.props.onError;\n          onError === null || onError === void 0 ? void 0 : onError(err, ret, origin);\n          delete _this2.reqs[uid];\n        }\n      };\n      onStart(origin);\n      this.reqs[uid] = request(requestOption);\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.setState({\n        uid: getUid()\n      });\n    }\n  }, {\n    key: \"abort\",\n    value: function abort(file) {\n      var reqs = this.reqs;\n\n      if (file) {\n        var uid = file.uid ? file.uid : file;\n\n        if (reqs[uid] && reqs[uid].abort) {\n          reqs[uid].abort();\n        }\n\n        delete reqs[uid];\n      } else {\n        Object.keys(reqs).forEach(function (uid) {\n          if (reqs[uid] && reqs[uid].abort) {\n            reqs[uid].abort();\n          }\n\n          delete reqs[uid];\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _classNames;\n\n      var _this$props4 = this.props,\n          Tag = _this$props4.component,\n          prefixCls = _this$props4.prefixCls,\n          className = _this$props4.className,\n          disabled = _this$props4.disabled,\n          id = _this$props4.id,\n          style = _this$props4.style,\n          multiple = _this$props4.multiple,\n          accept = _this$props4.accept,\n          children = _this$props4.children,\n          directory = _this$props4.directory,\n          openFileDialogOnClick = _this$props4.openFileDialogOnClick,\n          onMouseEnter = _this$props4.onMouseEnter,\n          onMouseLeave = _this$props4.onMouseLeave,\n          otherProps = _objectWithoutProperties(_this$props4, [\"component\", \"prefixCls\", \"className\", \"disabled\", \"id\", \"style\", \"multiple\", \"accept\", \"children\", \"directory\", \"openFileDialogOnClick\", \"onMouseEnter\", \"onMouseLeave\"]);\n\n      var cls = classNames((_classNames = {}, _defineProperty(_classNames, prefixCls, true), _defineProperty(_classNames, \"\".concat(prefixCls, \"-disabled\"), disabled), _defineProperty(_classNames, className, className), _classNames)); // because input don't have directory/webkitdirectory type declaration\n\n      var dirProps = directory ? {\n        directory: 'directory',\n        webkitdirectory: 'webkitdirectory'\n      } : {};\n      var events = disabled ? {} : {\n        onClick: openFileDialogOnClick ? this.onClick : function () {},\n        onKeyDown: openFileDialogOnClick ? this.onKeyDown : function () {},\n        onMouseEnter: onMouseEnter,\n        onMouseLeave: onMouseLeave,\n        onDrop: this.onFileDrop,\n        onDragOver: this.onFileDrop,\n        tabIndex: '0'\n      };\n      return /*#__PURE__*/React.createElement(Tag, _extends({}, events, {\n        className: cls,\n        role: \"button\",\n        style: style\n      }), /*#__PURE__*/React.createElement(\"input\", _extends({}, pickAttrs(otherProps, {\n        aria: true,\n        data: true\n      }), {\n        id: id,\n        type: \"file\",\n        ref: this.saveFileInput,\n        onClick: function onClick(e) {\n          return e.stopPropagation();\n        } // https://github.com/ant-design/ant-design/issues/19948\n        ,\n        key: this.state.uid,\n        style: {\n          display: 'none'\n        },\n        accept: accept\n      }, dirProps, {\n        multiple: multiple,\n        onChange: this.onChange\n      })), children);\n    }\n  }]);\n\n  return AjaxUploader;\n}(Component);\n\nexport default AjaxUploader;","map":{"version":3,"sources":["/home/anguilar/adora/react-app/node_modules/rc-upload/es/AjaxUploader.js"],"names":["_extends","_defineProperty","_objectWithoutProperties","_regeneratorRuntime","_typeof","_asyncToGenerator","_toConsumableArray","_classCallCheck","_createClass","_inherits","_createSuper","React","Component","classNames","pickAttrs","defaultRequest","getUid","attrAccept","traverseFileTree","AjaxUploader","_Component","_super","_this","apply","arguments","state","uid","reqs","onChange","e","files","target","uploadFiles","reset","onClick","el","fileInput","_this$props","props","children","type","parent","parentNode","focus","querySelector","blur","click","onKeyDown","key","onFileDrop","multiple","preventDefault","directory","Array","prototype","slice","call","dataTransfer","items","_file","accept","filter","file","originFiles","postFiles","map","processFile","Promise","all","then","fileList","onBatchStart","_ref","origin","parsedFile","forEach","post","_ref2","mark","_callee","_this$props2","beforeUpload","action","data","transformedFile","mergedAction","mergedData","wrap","_callee$","_context","prev","next","sent","t0","abrupt","name","stop","_x","_x2","saveFileInput","node","value","componentDidMount","_isMounted","componentWillUnmount","abort","_ref3","_this2","_this$props3","onStart","customRequest","headers","withCredentials","method","request","requestOption","filename","onProgress","onSuccess","ret","xhr","onError","err","setState","Object","keys","render","_classNames","_this$props4","Tag","component","prefixCls","className","disabled","id","style","openFileDialogOnClick","onMouseEnter","onMouseLeave","otherProps","cls","concat","dirProps","webkitdirectory","events","onDrop","onDragOver","tabIndex","createElement","role","aria","ref","stopPropagation","display"],"mappings":"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","sourcesContent":["import _extends from \"@babel/runtime/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime/helpers/esm/defineProperty\";\nimport _objectWithoutProperties from \"@babel/runtime/helpers/esm/objectWithoutProperties\";\nimport _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _typeof from \"@babel/runtime/helpers/esm/typeof\";\nimport _asyncToGenerator from \"@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _toConsumableArray from \"@babel/runtime/helpers/esm/toConsumableArray\";\nimport _classCallCheck from \"@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime/helpers/esm/createClass\";\nimport _inherits from \"@babel/runtime/helpers/esm/inherits\";\nimport _createSuper from \"@babel/runtime/helpers/esm/createSuper\";\nimport React, { Component } from 'react';\nimport classNames from 'classnames';\nimport pickAttrs from \"rc-util/es/pickAttrs\";\nimport defaultRequest from './request';\nimport getUid from './uid';\nimport attrAccept from './attr-accept';\nimport traverseFileTree from './traverseFileTree';\n\nvar AjaxUploader = /*#__PURE__*/function (_Component) {\n  _inherits(AjaxUploader, _Component);\n\n  var _super = _createSuper(AjaxUploader);\n\n  function AjaxUploader() {\n    var _this;\n\n    _classCallCheck(this, AjaxUploader);\n\n    _this = _super.apply(this, arguments);\n    _this.state = {\n      uid: getUid()\n    };\n    _this.reqs = {};\n\n    _this.onChange = function (e) {\n      var files = e.target.files;\n\n      _this.uploadFiles(files);\n\n      _this.reset();\n    };\n\n    _this.onClick = function (e) {\n      var el = _this.fileInput;\n\n      if (!el) {\n        return;\n      }\n\n      var _this$props = _this.props,\n          children = _this$props.children,\n          onClick = _this$props.onClick;\n\n      if (children && children.type === 'button') {\n        var parent = el.parentNode;\n        parent.focus();\n        parent.querySelector('button').blur();\n      }\n\n      el.click();\n\n      if (onClick) {\n        onClick(e);\n      }\n    };\n\n    _this.onKeyDown = function (e) {\n      if (e.key === 'Enter') {\n        _this.onClick(e);\n      }\n    };\n\n    _this.onFileDrop = function (e) {\n      var multiple = _this.props.multiple;\n      e.preventDefault();\n\n      if (e.type === 'dragover') {\n        return;\n      }\n\n      if (_this.props.directory) {\n        traverseFileTree(Array.prototype.slice.call(e.dataTransfer.items), _this.uploadFiles, function (_file) {\n          return attrAccept(_file, _this.props.accept);\n        });\n      } else {\n        var files = Array.prototype.slice.call(e.dataTransfer.files).filter(function (file) {\n          return attrAccept(file, _this.props.accept);\n        });\n\n        if (multiple === false) {\n          files = files.slice(0, 1);\n        }\n\n        _this.uploadFiles(files);\n      }\n    };\n\n    _this.uploadFiles = function (files) {\n      var originFiles = _toConsumableArray(files);\n\n      var postFiles = originFiles.map(function (file) {\n        // eslint-disable-next-line no-param-reassign\n        file.uid = getUid();\n        return _this.processFile(file, originFiles);\n      }); // Batch upload files\n\n      Promise.all(postFiles).then(function (fileList) {\n        var onBatchStart = _this.props.onBatchStart;\n        onBatchStart === null || onBatchStart === void 0 ? void 0 : onBatchStart(fileList.map(function (_ref) {\n          var origin = _ref.origin,\n              parsedFile = _ref.parsedFile;\n          return {\n            file: origin,\n            parsedFile: parsedFile\n          };\n        }));\n        fileList.filter(function (file) {\n          return file.parsedFile !== null;\n        }).forEach(function (file) {\n          _this.post(file);\n        });\n      });\n    };\n    /**\n     * Process file before upload. When all the file is ready, we start upload.\n     */\n\n\n    _this.processFile = /*#__PURE__*/function () {\n      var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(file, fileList) {\n        var _this$props2, beforeUpload, action, data, transformedFile, mergedAction, mergedData, parsedFile;\n\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this$props2 = _this.props, beforeUpload = _this$props2.beforeUpload, action = _this$props2.action, data = _this$props2.data;\n                transformedFile = file;\n\n                if (!beforeUpload) {\n                  _context.next = 14;\n                  break;\n                }\n\n                _context.prev = 3;\n                _context.next = 6;\n                return beforeUpload(file, fileList);\n\n              case 6:\n                transformedFile = _context.sent;\n                _context.next = 12;\n                break;\n\n              case 9:\n                _context.prev = 9;\n                _context.t0 = _context[\"catch\"](3);\n                // Rejection will also trade as false\n                transformedFile = false;\n\n              case 12:\n                if (!(transformedFile === false)) {\n                  _context.next = 14;\n                  break;\n                }\n\n                return _context.abrupt(\"return\", {\n                  origin: file,\n                  parsedFile: null,\n                  action: null,\n                  data: null\n                });\n\n              case 14:\n                if (!(typeof action === 'function')) {\n                  _context.next = 20;\n                  break;\n                }\n\n                _context.next = 17;\n                return action(file);\n\n              case 17:\n                mergedAction = _context.sent;\n                _context.next = 21;\n                break;\n\n              case 20:\n                mergedAction = action;\n\n              case 21:\n                if (!(typeof data === 'function')) {\n                  _context.next = 27;\n                  break;\n                }\n\n                _context.next = 24;\n                return data(file);\n\n              case 24:\n                mergedData = _context.sent;\n                _context.next = 28;\n                break;\n\n              case 27:\n                mergedData = data;\n\n              case 28:\n                parsedFile = // string type is from legacy `transformFile`.\n                // Not sure if this will work since no related test case works with it\n                (_typeof(transformedFile) === 'object' || typeof transformedFile === 'string') && transformedFile ? transformedFile : file; // Used for `request.ts` get form data name\n\n                if (_typeof(parsedFile) === 'object' && !parsedFile.name) {\n                  parsedFile.name = file.name;\n                }\n\n                return _context.abrupt(\"return\", {\n                  origin: file,\n                  data: mergedData,\n                  parsedFile: parsedFile,\n                  action: mergedAction\n                });\n\n              case 31:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[3, 9]]);\n      }));\n\n      return function (_x, _x2) {\n        return _ref2.apply(this, arguments);\n      };\n    }();\n\n    _this.saveFileInput = function (node) {\n      _this.fileInput = node;\n    };\n\n    return _this;\n  }\n\n  _createClass(AjaxUploader, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      this._isMounted = true;\n    }\n  }, {\n    key: \"componentWillUnmount\",\n    value: function componentWillUnmount() {\n      this._isMounted = false;\n      this.abort();\n    }\n  }, {\n    key: \"post\",\n    value: function post(_ref3) {\n      var _this2 = this;\n\n      var data = _ref3.data,\n          origin = _ref3.origin,\n          action = _ref3.action,\n          parsedFile = _ref3.parsedFile;\n\n      if (!this._isMounted) {\n        return;\n      }\n\n      var _this$props3 = this.props,\n          onStart = _this$props3.onStart,\n          customRequest = _this$props3.customRequest,\n          name = _this$props3.name,\n          headers = _this$props3.headers,\n          withCredentials = _this$props3.withCredentials,\n          method = _this$props3.method;\n      var uid = origin.uid;\n      var request = customRequest || defaultRequest;\n      var requestOption = {\n        action: action,\n        filename: name,\n        data: data,\n        file: parsedFile,\n        headers: headers,\n        withCredentials: withCredentials,\n        method: method || 'post',\n        onProgress: function onProgress(e) {\n          var onProgress = _this2.props.onProgress;\n          onProgress === null || onProgress === void 0 ? void 0 : onProgress(e, origin);\n        },\n        onSuccess: function onSuccess(ret, xhr) {\n          var onSuccess = _this2.props.onSuccess;\n          onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(ret, origin, xhr);\n          delete _this2.reqs[uid];\n        },\n        onError: function onError(err, ret) {\n          var onError = _this2.props.onError;\n          onError === null || onError === void 0 ? void 0 : onError(err, ret, origin);\n          delete _this2.reqs[uid];\n        }\n      };\n      onStart(origin);\n      this.reqs[uid] = request(requestOption);\n    }\n  }, {\n    key: \"reset\",\n    value: function reset() {\n      this.setState({\n        uid: getUid()\n      });\n    }\n  }, {\n    key: \"abort\",\n    value: function abort(file) {\n      var reqs = this.reqs;\n\n      if (file) {\n        var uid = file.uid ? file.uid : file;\n\n        if (reqs[uid] && reqs[uid].abort) {\n          reqs[uid].abort();\n        }\n\n        delete reqs[uid];\n      } else {\n        Object.keys(reqs).forEach(function (uid) {\n          if (reqs[uid] && reqs[uid].abort) {\n            reqs[uid].abort();\n          }\n\n          delete reqs[uid];\n        });\n      }\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _classNames;\n\n      var _this$props4 = this.props,\n          Tag = _this$props4.component,\n          prefixCls = _this$props4.prefixCls,\n          className = _this$props4.className,\n          disabled = _this$props4.disabled,\n          id = _this$props4.id,\n          style = _this$props4.style,\n          multiple = _this$props4.multiple,\n          accept = _this$props4.accept,\n          children = _this$props4.children,\n          directory = _this$props4.directory,\n          openFileDialogOnClick = _this$props4.openFileDialogOnClick,\n          onMouseEnter = _this$props4.onMouseEnter,\n          onMouseLeave = _this$props4.onMouseLeave,\n          otherProps = _objectWithoutProperties(_this$props4, [\"component\", \"prefixCls\", \"className\", \"disabled\", \"id\", \"style\", \"multiple\", \"accept\", \"children\", \"directory\", \"openFileDialogOnClick\", \"onMouseEnter\", \"onMouseLeave\"]);\n\n      var cls = classNames((_classNames = {}, _defineProperty(_classNames, prefixCls, true), _defineProperty(_classNames, \"\".concat(prefixCls, \"-disabled\"), disabled), _defineProperty(_classNames, className, className), _classNames)); // because input don't have directory/webkitdirectory type declaration\n\n      var dirProps = directory ? {\n        directory: 'directory',\n        webkitdirectory: 'webkitdirectory'\n      } : {};\n      var events = disabled ? {} : {\n        onClick: openFileDialogOnClick ? this.onClick : function () {},\n        onKeyDown: openFileDialogOnClick ? this.onKeyDown : function () {},\n        onMouseEnter: onMouseEnter,\n        onMouseLeave: onMouseLeave,\n        onDrop: this.onFileDrop,\n        onDragOver: this.onFileDrop,\n        tabIndex: '0'\n      };\n      return /*#__PURE__*/React.createElement(Tag, _extends({}, events, {\n        className: cls,\n        role: \"button\",\n        style: style\n      }), /*#__PURE__*/React.createElement(\"input\", _extends({}, pickAttrs(otherProps, {\n        aria: true,\n        data: true\n      }), {\n        id: id,\n        type: \"file\",\n        ref: this.saveFileInput,\n        onClick: function onClick(e) {\n          return e.stopPropagation();\n        } // https://github.com/ant-design/ant-design/issues/19948\n        ,\n        key: this.state.uid,\n        style: {\n          display: 'none'\n        },\n        accept: accept\n      }, dirProps, {\n        multiple: multiple,\n        onChange: this.onChange\n      })), children);\n    }\n  }]);\n\n  return AjaxUploader;\n}(Component);\n\nexport default AjaxUploader;"]},"metadata":{},"sourceType":"module"}